import t from"axios";import{stringify as e}from"qs";import r from"sweetalert2";function n(){return n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},n.apply(this,arguments)}function a(t){return Object.is(t,null)}function o(t){return function(t){return Object.is(t,void 0)}(t)||a(t)}function i(t){return"string"==typeof t}function s(t){return i(t)&&""!==t.trim()}function c(t){return"object"==typeof t&&!a(t)&&!function(t){return Array.isArray(t)}(t)}function u(t){const e=n({width:500,iconHtml:'<i class="bi bi-exclamation-circle text-primary"></i>',customClass:{icon:"border-0 mt-0 mb-3",confirmButton:"btn btn-primary px-4 py-2"},showClass:{popup:"animate__animated animate__fadeInUp animate__faster",backdrop:"swal2-backdrop-show"},hideClass:{popup:"animate__animated animate__fadeOutDown animate__faster",backdrop:"swal2-backdrop-hide"}},t);return r.fire(e)}function f(r,a,o){const i=t.create();return i.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",i.defaults.headers.put["Content-Type"]="application/x-www-form-urlencoded",i.defaults.headers.patch["Content-Type"]="application/x-www-form-urlencoded",i.interceptors.response.use(b,y),i.request(n({method:r,url:a,timeout:0,paramsSerializer:t=>e(t,{arrayFormat:"brackets"}),withCredentials:!1,responseType:"json"},o))}function d(t,e,r){return o(e)&&(e={}),o(r)&&(r={}),f("GET",t,n({params:e},r))}function p(t,e,r){return o(r)&&(r={}),f("POST",t,n({data:e},r))}function m(t,e,r){return o(r)&&(r={}),f("PUT",t,n({data:e},r))}function l(t,e,r){return o(r)&&(r={}),f("PATCH",t,n({data:e},r))}function h(t){let e;if(t instanceof Error){if(o(t.response))return void u({text:"网络繁忙（400001），请稍后再试",confirmButtonText:"关 闭"}).then(()=>{});c(t.response)&&!o(t.response.data)&&(t=t.response)}c(t)||u({text:"网络繁忙（400002），请稍后再试",confirmButtonText:"关 闭"}).then(()=>{});const r=n({},t).data;if(c(r)||u({text:"网络繁忙（400003），请稍后再试",confirmButtonText:"关 闭"}).then(()=>{}),e="网络繁忙（400000），请稍后再试",s(r.err)&&(e=r.err),r.retCode>=500)e="网络繁忙（400500），请稍后再试";else if(401===r.retCode)e="网络繁忙（400401），请稍后再试";else if(403===r.retCode)e="网络繁忙（400403），请稍后再试";else if(404===r.retCode)e="网络繁忙（400404），请稍后再试";else if(r.retCode>=400)if(Array.isArray(r.data))c(r.data[0])&&s(r.data[0].message)&&(e=r.data[0].message);else if(c(r.data))if(s(r.data.err))e=r.data.err;else if(c(r.data.err)){const t=Object.values(r.data.err);s(t[0])?e=t[0]:Array.isArray(t[0])&&s(t[0][0])&&(e=t[0][0])}else s(r.data.message)&&(e=r.data.message);u({text:e,confirmButtonText:"关 闭"}).then(()=>{})}const b=t=>{if("blob"===t.config.responseType)return t;const e=n({},t.headers),a={};Object.keys(e).forEach(t=>{const r=t.toLowerCase();let n=e[t];0===r.indexOf("x-pagination-")&&function(t){if(function(t){return Number.isInteger(t)}(t))return!0;if(i(t)){if("0"===t)return!0;if("-"===t.charAt(0)&&(t=t.slice(1)),/^[1-9]\d*$/.test(t))return!0}return!1}(n)&&(n*=1),a[r]=n}),t.headers=a;const o=n({},t).data;return o.isOk?(c(o.data)&&(t.data=o.data),s(t.data.toast)&&function(t){const e=n({toast:!0,showConfirmButton:!1,timer:3e3},t);return r.fire(e)}({title:t.data.toast,icon:"success"}).then(()=>{}),t):(h(t),!1)},y=t=>(h(t),!1);export{d as ajaxGet,h as ajaxHandleError,l as ajaxPatch,p as ajaxPost,m as ajaxPut,f as ajaxRequest};
//# sourceMappingURL=ajax.modern.js.map
